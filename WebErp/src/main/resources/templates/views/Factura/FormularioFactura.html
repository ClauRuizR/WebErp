<html class="no-js" xmlns:th="http://www.thymeleaf.org">
<head>


</head>
<body>
	<div th:fragment="content">
		<div class="notifications top-rigth"></div>
		<div id="page-content">
			<div class="content-header">
				<ul class="nav-horizontal text-center">
					<!-- 	<li class="active"><a href="javascript:void(0)"><i
							class="fa fa-home"></i> Home</a></li> -->
				</ul>
				<div class="header-section">
					<h1>
						Formulario de Documentos

						<!-- <i class="gi gi-table">Formulario de clientes</i><br> -->
					</h1>
				</div>
				<div class="row">
					<form id="formFactura" class="form-horizontal form-bordered"
						th:object="${factura}" method="post"
						th:action="@{/facturas/guardar}">
						<input type="hidden" th:field="${factura.id}" /> <input
							type="hidden" th:field="${factura.version}" />
						<div class="col-md-12">
							<!-- Basic Form Elements Block -->
							<div class="block" style="margin-left: 20px !important;">
								<!-- Basic Form Elements Title -->
								<div class="block-title">
									<div class="block-options pull-right"></div>
									<h2>
										<strong>Datos B&aacute;sicos </strong>
									</h2>
								</div>

								<div class="col-md-6">
									<div class="form-group">
										<label class="col-md-3 control-label">Numero Documento</label>
										<div class="col-md-9">
											<input type="text" readonly="readonly"
												th:field="${factura.numeroDocumento}" class="form-control"></input>
										</div>
									</div>
									<div class="form-group has-error">
										<label class="col-md-3 control-label">Tipo Documento</label>
										<div class="col-md-9">

											<select th:field="${factura.tipoDocumento.llaveDocumento}"
												id="selectTipoFactura" class="select-chosen">
												<option value="">Seleccione</option>
												<option th:each="entry : ${tipoDocumentoList}"
													th:disabled="${factura.estatus != 'P'}"
													th:value="${entry.llaveDocumento}"
													th:text="${entry.documento}" />


											</select> <span class="help-block"
												th:if="${#fields.hasErrors('tipoDocumento')}"
												th:errors="*{tipoDocumento}">Factura Error</span>
										</div>
									</div>
									<div class="form-group has-error">
										<label class="col-md-3 control-label">Cliente</label>
										<div class="col-md-9">

											<select th:field="${factura.cliente.id}"
												class="select-chosen">
												<option value="">Seleccione</option>
												<option th:each="entry : ${clienteList}"
													th:disabled="${factura.estatus != 'P'}"
													th:value="${entry.id}" th:text="${entry.nombre}"
													th:selected="${clienteList.contains(entry)}" />


											</select> <span class="help-block"
												th:if="${#fields.hasErrors('cliente')}"
												th:errors="*{cliente}">Cliente Error</span>
										</div>
									</div>


									<div class="form-group">
										<label class="col-md-3 control-label">Comprobante
											Fiscal</label>
										<div class="col-md-9">
											<input type="checkbox" id="chkconComprobanteFiscal"
												class="form-control" size="1"
												th:field="${factura.comprobanteFiscal}"> </input> <input
												type="text" id="txtComprobanteFiscal" readonly="readonly"
												th:field="${factura.numeroComprobanteFiscal}"
												class="form-control"></input>
										</div>
									</div>
									<div class="form-group has-error">
										<label class="col-md-3 control-label">Descuento</label>
										<div class="col-md-9">
											<input type="number" th:field="${factura.descuento}"
												th:readonly="${factura.estatus != 'P'}" class="form-control"></input>
											<span class="help-block"
												th:if="${#fields.hasErrors('descuento')}"
												th:errors="*{descuento}">Cliente Error</span>
										</div>
									</div>

									<div class="form-group">
										<label class="col-md-3 control-label">Estatus</label>
										<div class="col-md-9">
											<select id="estatus" name="estatus" class="form-control"
												disabled="disabled" size="1" th:field="${factura.estatus}">
												<option value="P">Pendiente</option>
												<option value="A">Aprobada</option>
												<option value="X">Pagada</option>
											</select>
										</div>
									</div>
									<div class="form-group">
										<label class="col-md-3 control-label" for="estado">Estado</label>
										<div class="col-md-9">
											<select id="estado" disabled="disabled" name="estado"
												th:disabled="${factura.estatus != 'P'}" class="form-control"
												size="1" th:field="${factura.estado}">
												<option value="1">Activo</option>
												<option value="0">Inactivo</option>
											</select>
										</div>
									</div>
								</div>
								<div class="block">
									<!-- Table Styles Title -->
									<div class="block-title"></div>
									<div class="table-options clearfix">
										<div class="btn-group btn-group-sm pull-left"></div>
									</div>
									<div class="block-title">
										<h2>
											<strong>Detalle Factura</strong>
										</h2>
									</div>
									<div class="form-horizontal form-bordered">



										<button name="agregarDetalleFactura"
											class="btn btn-alt btn-sm btn-success"
											th:if="${factura.DetalleFactura.size() &lt; 5}"
											th:disabled="${factura.estatus != 'P'}"
											onclick="editarDetalleFactura('formFactura', '/facturas/agregarDetalleFactura#detalleFactura');">
											<i class="hi hi-plus-sign"></i> Agregar Detalle
										</button>

										<table class="table table-striped table-vcenter"
											id="detalleFactura">
											<thead>
												<tr>
													<th style="display: none" class="text-center">&Iacute;ndice</th>
													<th id="thnumeroFactura" class="text-center">Indice</th>
													<th id="thProducto" class="text-center">Producto</th>
													<th id="thPrecio" class="text-center">Precio</th>
													<th id="thCantidad" class="text-center">Cantidad</th>
													<th id="thCantidad" class="text-center">Itbis</th>
													<th id="thmonto" class="text-center">Monto</th>
													<th class="text-center"></th>
													<th class="text-center"></th>
													<th class="text-center"></th>
												</tr>
											</thead>
											<tbody>
												<tr th:each="DetalleFactura, rowStat : *{DetalleFactura}">
													<td th:text="${rowStat.count}" class="text-center">1</td>

													<td id="tdfacturaid" class="text-center">
														<div class="form-group has-error">
															<select
																th:onchange="'javascript:getPrecio(\'' + ${rowStat.count} + '\', this.value);'"
																th:field="*{DetalleFactura[__${rowStat.index}__].producto.Id}"
																class="select-chosen" id="chkFacturaProducto">
																<option value="">Seleccione</option>
																<option th:each="entry : ${productoLista}"
																	th:disabled="${factura.estatus != 'P'}"
																	th:value="${entry.id}"
																	th:text="${entry.nombre} +'-'+ ${entry.precio}" />


															</select> <span class="help-block"
																th:if="${#fields.hasErrors('*{DetalleFactura[__${rowStat.index}__].producto}')}"
																th:errors="*{DetalleFactura[__${rowStat.index}__].producto}">Factura
																Error</span>
														</div>
													</td>
													<td id="tdPrecio" class="text-center">
														<div class="form-group">
															<input class="form-control" id="txtFacturaPrecio"
																th:field="*{DetalleFactura[__${rowStat.index}__].precio}"
																readonly="readonly" type="number"></input>

														</div>
													</td>
													<td id="tdCantidad" class="text-center">
														<div class="form-group has-error">
															<input th:readonly="${factura.estatus != 'P'}"
																class="form-control"
																th:field="*{DetalleFactura[__${rowStat.index}__].cantidad}"
																type="number"></input> <span class="help-block"
																th:if="${#fields.hasErrors('*{DetalleFactura[__${rowStat.index}__].cantidad}')}"
																th:errors="*{DetalleFactura[__${rowStat.index}__].cantidad}">Factura
																Error</span>
														</div>
													</td>
													<td id="tdCantidad" class="text-center"><input
														class="form-control" readonly="readonly"
														th:field="*{DetalleFactura[__${rowStat.index}__].itbis}"
														type="number"></input></td>

													<td id="tdmonto" class="text-center"><input
														id="resultMontoTotal" class="form-control"
														readonly="readonly"
														th:field="*{DetalleFactura[__${rowStat.index}__].monto}"></input></td>


													<td>
														<button name="quitarDetalleFactura"
															class="fa fa-trash btn btn-danger"
															th:value="${rowStat.index}"
															th:disabled="${factura.estatus != 'P'}"
															onclick="editarDetalleFactura('formFactura', '/facturas/quitarDetalleFactura#detalleFactura');"></button>
													</td>

													<td id="tdmonto" class="text-center" hidden="hidden"><input
														id="resultMontoTotal" class="form-control"
														readonly="readonly"
														th:field="*{DetalleFactura[__${rowStat.index}__].id}"></input></td>
													<td id="tdmonto" class="text-center" hidden="hidden"><input
														id="resultMontoTotal" class="form-control"
														readonly="readonly"
														th:field="*{DetalleFactura[__${rowStat.index}__].version}"></input></td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>

								<div class="block-title">
									<div class="block-options pull-right"></div>
									<div class="form-group form-actions"
										style="margin-left: 20px !important;">
										<div class="col-md-9 col-md-offset-3">
											<button id="guardar" type="submit"
												th:disabled="${factura.estatus != 'P'}"
												class="btn btn-alt btn-sm btn-primary">
												<i class="fa fa-angle-right"></i> Guardar
											</button>
											
												<a class="btn btn-alt btn-sm btn-default"
												th:href="@{/facturas/crear}">Agregar Otro</a>
												
											<a class="btn btn-alt btn-sm btn-default"
												th:href="@{/facturas}"><i class="gi gi-exit"></i> Salir</a>
										</div>
									</div>
								</div>

							</div>

						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</body>
</html>